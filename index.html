<!DOCTYPE html>
<link href="https://www.w3schools.com/w3css/4/w3.css" rel="stylesheet">
<html lang="en">
<head>
    <title>Glaceon discord bot</title>
</head>
<div class="w3-blue w3-container" id="info">
    Hello! This is Glaceon's wip logging site. For now, the logs are not accessible to anyone but me, but they will be
    soon(tm)!
</div>
<iframe src="https://discord.com/widget?id=820423464498364436&theme=dark" width="350" height="500" allowtransparency="true" frameborder="0" sandbox="allow-popups allow-popups-to-escape-sandbox allow-same-origin allow-scripts"></iframe>
<div class="w3-purple w3-container w3-margin w3-center"
<div class="w3-blue w3-container">
    <a href="https://randomairborne.dev/glaceon" id="learn">Learn More</a>
</div>
<div class="w3-blue w3-container">
    <a href="https://discord.com/api/oauth2/authorize?client_id=808149899182342145&redirect_uri=https%3A%2F%2Fglaceon.xyz%2Flogs&response_type=code&scope=identify%20guilds" id="login"
       style="display: none;">Identify
        Yourself (WIP)</a>
    <script>
        window.onload = () => {
            const fragment = new URLSearchParams(window.location.hash.slice(1));
            const [accessToken, tokenType, state] = [fragment.get('access_token'), fragment.get('token_type'), fragment.get('state')];

            if (!accessToken) {
                return document.getElementById('login').style.display = 'block';
            }
            if (localStorage.getItem('oauth-state') !== atob(decodeURIComponent(state))) {
                return console.log('You may have been clickjacked!');
            }
            fetch('https://discord.com/api/users/@me', {
                headers: {
                    authorization: `${tokenType} ${accessToken}`
                }
            })
                .then(result => result.json())
                .then(response => {
                    const {username, discriminator} = response;
                    document.getElementById('info').innerText += ` ${username}#${discriminator}`;
                })
                .catch(console.error);
        };
    </script>
</div>
</html>

